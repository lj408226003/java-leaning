## Vue学习笔记-组件



### 1.模块与模块化

模块之前讲过，他指的是js的拆分，一个独立的js功能可以叫做一个模块，一个工程中所有js都是以最小化模块来编写，那么这个工程就是模块化工程。



特点：复用、灵活、可扩展

### 2.组件与组件化

组件说的是html页面的拆分，一个独立的局部页面可以封装成一个组件，它一般具有独立的功能，且组件一般是代码的集合(包括html、css、js)和资源(image/mp3等)。

如果一个工程都以组件来开发，那么这个工程就是组件化工程。



特点：复用、灵活、可扩展



### 3.组件的分类

组件分为单文件组件和非单文件组件

#### ①非单文件组件

> 他指的是在一个html文件中存在多个组件，可能是1个也可能是n个，注意理解概念。

```js
Vue中使用组件的三大步骤：
	一、定义组件(创建组件)：Vue.extend，extend翻译过来是扩展的意思
	二、注册组件：将定义的组件注册给Vue的实例对象，建立关系
	三、使用组件(写组件标签)：在建立管理的Vue实例绑定的容器模板中使用组件

一、如何定义一个组件？
	使用Vue.extend(options)创建，其中options和new Vue(options)时传入的那个options几乎一样，但也有点区别；
	区别如下：
		1.el不要写，为什么？ ——— 最终所有的组件都要经过一个vm的管理，由vm中的el决定服务哪个容器。
		2.data必须写成函数，为什么？ ———— 避免组件被复用时，数据存在引用都指向同一个对象，导致同时联动修改。
	问题：定义了组件，组件的html内容在哪写呢？因为没有了el属性，那就没有被指向的容器模板了，此时需要使用template属性定义。
  备注：使用template可以配置组件结构体，但一定要有一个根标签，否则Vue不识别。

二、定义组件【简写方式】
	
	const component = Vue.extend(options)  <==>  const component = options
	
三、如何注册组件？
	1.局部注册：靠new Vue的时候传入components属性
	2.全局注册：靠Vue.component('组件名',组件实例对象)

三、编写组件标签：直接用组件的属性名即可。
	<school></school>
	<school/> // 这种方式建议在脚手架模式，如果普通纯敲代码模式会有些问题
```

```js
## 举例说明：
<!-- 第1个容器root -->
<div id="root">
  <hello></hello>
  <hr>
  <h1>{{msg}}</h1>
  <hr>
  <!-- 使用组件，直接以组件名作为标签即可 -->
  <school></school>
  <hr>
  <!-- 使用组件 -->
  <student></student>
</div>
<!-- 第2个容器root -->
<div id="root2">
  <hello></hello>
</div>

<script type="text/javascript">
	Vue.config.productionTip = false

	// 1.创建school组件：传入的参数和new Vue时传入的参数基本相同，意义也相同
	const school = Vue.extend({
		template:`
			<div class="demo">
				<h2>学校名称：{{schoolName}}</h2>
				<h2>学校地址：{{address}}</h2>
				<button @click="showName">点我提示学校名</button>	
			</div>
		`,
		// el:'#root', //组件定义时，一定不要写el配置项，因为最终所有的组件都要被一个vm管理，由vm决定服务于哪个容器。
		data(){
			return {
				schoolName:'尚硅谷',
				address:'北京昌平'
			}
		},
		methods: {
			showName(){
				alert(this.schoolName)
			}
		},
	})

	// 1.创建student组件
	const student = Vue.extend({
		template:`
			<div>
				<h2>学生姓名：{{studentName}}</h2>
				<h2>学生年龄：{{age}}</h2>
			</div>
		`,
		data(){
			return {
				studentName:'张三',
				age:18
			}
		}
	})
	
	// 1.创建hello组件【简写方式】
	const hello = {
		template:`
			<div>	
				<h2>你好啊！{{name}}</h2>
			</div>
		`,
		data(){
			return {
				name:'Tom'
			}
		}
	};
	
	// 2.注册组件【全局注册】
	Vue.component('hello',hello)

	// 3.创建vm
	new Vue({
		el:'#root',
		data:{
			msg:'你好啊！'
		},
		// 4.注册组件（局部注册）
		components:{
			school,
			student
		}
	})
  // 为了演示全局注册的组件能给el=#root2的Vue实例对象使用
	new Vue({
		el:'#root2',
	})
</script>
```

> 定义组件的建议：【知道就好，习惯问题】
>
> ①组件名建议首字母大写(与浏览器中Vue开发者工具试图的组件名一致，因为你定义全消息，工具试图也会显示首字母大写，虽然不影响但不优雅)
>
> ②如果组件名由多个单词组成，可以全部小写，以"-"连接，注意要用引号包起来，
>
> [注意：多单词时Vue浏览器工具的试图不论你怎么定义，都以首字母大写显示，如下边的例子，工具试图会以SchoolStruct和School这两个名字显示]
>
> 基于此，所以建议以首字母大写直接定义就行了
>
> ```
> components:{
>   "SchoolStruct": schoolStruct,  //首字母大写方式定义，注意这种方式如果不适用vue-cli脚手架会有些问题，暂时忽略即可
>   "Student": student
> }
> ```
>
> ③从上边看Vue的浏览器开发者工具试图上显示的名字比较特殊，不管你组件名是啥，他都有自己的原则，其实他是获取的Vue.extend创建组件时指定的name属性值，
>
> 如果不配置他就自动生成，而我们上边说的都是自动生成的规则，如果想更改可以自定义name属性就行了。



#### ②嵌套组件

就是一个大组件中包含多个小组件，借助在Vue.extend()传入的options的components属性建立父子关系，

并且实际开发中一般vm下只有一个叫做App的组件，由这个组件管理所有组件，这样结构清晰。

```html
<!-- 准备好一个容器，内容都通过组件来实现，即写到template属性会合理写 -->
<div id="root"></div>

<script type="text/javascript">
	Vue.config.productionTip = false //阻止 vue 在启动时生成生产提示。

	//定义student组件
	const student = Vue.extend({
		name:'student',
		template:`
			<div>
				<h2>学生姓名：{{name}}</h2>	
				<h2>学生年龄：{{age}}</h2>	
			</div>
		`,
		data(){
			return {
				name:'尚硅谷',
				age:18
			}
		}
	})
	
	//定义school组件
	const school = Vue.extend({
		name:'school',
		template:`
			<div>
				<h2>学校名称：{{name}}</h2>	
				<h2>学校地址：{{address}}</h2>	
				<student></student>
			</div>
		`,
		data(){
			return {
				name:'尚硅谷',
				address:'北京'
			}
		},
		//注册组件（局部）
		components:{
			student
		}
	})

	//定义hello组件
	const hello = Vue.extend({
		template:`<h1>{{msg}}</h1>`,
		data(){
			return {
				msg:'欢迎来到尚硅谷学习！'
			}
		}
	})
	
	//定义app组件【一般用来管理所有组件】
	const app = Vue.extend({
		template:`
			<div>	
				<hello></hello>
				<school></school>
			</div>
		`,
		components:{
			school,
			hello
		}
	})

	//创建vm
	new Vue({
		template:'<app></app>', // 为了保持页面简洁，把内容写到template中
		el:'#root',
		//注册组件（局部）
		components:{app}
	})
</script>
```

#### ③VueComponent

我们知道new Vue()是创建了个Vue的实例对象，那么创建组件时干了什么呢？就是说Vue.extend(ops)干了什么？

=> 通过控制台输出可知，他返回了一个VueComponent的构造函数，比如const school = Vue.extend()，那school其实是个构造函数，

注册就是将school这个构造函数添加给了Vue的实例对象，当页面通过<school></school>使用时，

Vue会根据school的构造函数创建一个VueComponent的实例对象(new VueComponent())并进行应用。

> 关于VueComponent：
>
> 1.school组件本质是一个名为VueComponent的构造函数，且不是程序员定义的，是Vue.extend生成的。
>
> 2.我们只需要写<school/>或<school></school>，Vue解析时会帮我们创建school组件的实例对象，
> 	即Vue帮我们执行的：new VueComponent(options)。
>
> <font color="red">3.特别注意：每次调用Vue.extend，返回的都是一个全新的VueComponent！！！！</font>
>
> 4.关于this指向：
> (1).组件配置中：
> 	data函数、methods中的函数、watch中的函数、computed中的函数 它们的this均是【VueComponent实例对象】。
> (2).new Vue(options)配置中：
> 	data函数、methods中的函数、watch中的函数、computed中的函数 它们的this均是【Vue实例对象】。
>
> 5.VueComponent的实例对象，以后简称vc（也可称之为：组件实例对象）。
> 	Vue的实例对象，以后简称vm。

#### ④一个重要的内置关系

> 1.一个重要的内置关系：VueComponent.prototype.\_\_proto\_\_ === Vue.prototype
> 2.为什么要有这个关系：让组件实例对象（vc）可以访问到 Vue原型上的属性、方法。
>
> <font color="red">[其实就是在说：VueComponent构造函数是由Vue创建的，所以VueComponent的实例对象的\_\_proto\_\_会指向Vue的prototype]</font>
>
> <img src="/Users/lij/markdownWorkspace/java-leaning/resources/image-20220529185159557.png" alt="image-20220524002415862" style="zoom:33%;" align="left"/>

#### ⑤单文件组件

> 单文件组件指的是vue文件格式的组件，即[.vue]结尾的文件，这个文件中只允许有一个组件。
>
> [注意]：Vue中引入/导出组件文件和引入/导出模块js文件是一样的语法，即组件写完后需要导出，而要引用组件的地方需要导入，语法和模块的导入导出一样
>
> [注意]：Vue中只能用es6语法导入/导出，不能使用CommonJS语法，Vue不支持。

> 重要步骤：其实定义单文件组件很简单，把一个文件多个组件里的每个组件都拿出来定义一个vue组件文件就行了，当然组件文件中要包含组件的所有内容
>
> - 创建一个组件文件，如School.vue，文件名尽量和组件名一致
> - 将组件的html内容拿到vue组件文件中，使用<template>标签，他和template属性一样的效果
> - 将VueComponent对象的属性拿到文件，直接通过<script>标签定义即可，这里和非单文件有些区别，需要手动导出
> - 将style内容直接在组件文件中以<style>书写即可
> - 在需要使用组件的主文件，即带有Vue实例对象的文件，通过导入的方式导入组件
>
> 
>
> 组件文件内容的组成如下：[xxx.vue]
>
> ```vue
> <template>
> 	<!-- 组件的结构 -->
> </template>
> 
> <script>
> 	// 组件交互相关的代码(数据、方法等)
> </script>
> 
> <style>
> 	## 组件的样式
> </style>
> ```

```vue
// 1.创建组件文件School.vue
<template>
	<div class="demo">
		<h2>学校名称：{{name}}</h2>
		<h2>学校地址：{{address}}</h2>
		<button @click="showName">点我提示学校名</button>	
	</div>
</template>

<script>
	 // 通过es6语法的默认导出方式导出组件，其实就是导出了一个VueComponent的构造函数，这里采用了简写的方式
	 // 相当于 export default Vue.extend({...});
	 export default {
		name:'School', // 组件名字和文件名保持一直，可读性更好
		data(){  // 这个数据当然是给本组件使用的哦
			return {
				name:'尚硅谷',
				address:'北京昌平'
			}
		},
		methods: {
			showName(){
				alert(this.name)
			}
		},
	}
</script>
<!-- 本模块使用的样式 -->
<style>
	.demo{
		background-color: orange;
	}
</style>
```

```vue
// 2.创建组件Student.vue
<template>
	<div>
		<h2>学生姓名：{{name}}</h2>
		<h2>学生年龄：{{age}}</h2>
	</div>
</template>

<script>
	 export default {
		name:'Student',
		data(){
			return {
				name:'张三',
				age:18
			}
		}
	}
</script>
```

```vue
// 3.创建App.vue总管组件：用来管理所有子组件
<template>
	<div>
    <!-- 应用子组件 -->
		<School></School>
		<Student></Student>
	</div>
</template>

<script>
	// 导入组件：通过es6语法导入
	import School from './School.vue'
	import Student from './Student.vue'

	export default {
		name:'App',
    // 关联子组件
		components:{
			School,
			Student
		}
	}
</script>	
```

```javascript
// 4.创建Vue实例：模块都定义完了，最后需要创建Vue实例对象，将组件应用起来
// [注意]简单的时候我们可以把Vue实例对象直接创建到html中，但实际开发我们一般定义一个主文件，专门定义Vue的实例，因为只是创建Vue的实例，所以是一个js文件，
// 一般取名为main.js或app.js或index.js ，此处我们用main.js

// 首先导入主模块
import App from './App.vue'

// 创建Vue实例，并绑定到id=root的容器，并应用App.vue这个组件
new Vue({
	el:'#root',
	template:`<App></App>`, // 这里直接写是为了精简html的id=root容器处的代码，可以说是解耦
	components:{App},
})
```

```html
// 5.最后创建入口html文件：index.html

<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>练习一下单文件组件的语法</title>
	</head>
	<body>
		<!-- 准备一个容器 -->
		<div id="root"></div>
		
		<!-- 导入Vue.js和主文件main.js -->
		<script type="text/javascript" src="../js/vue.js"></script>
		<script type="text/javascript" src="./main.js"></script>
	</body>
</html>
```

> <font color="red">重点</font>：以上我们定义了一堆vue文件，那么浏览器是不能识别的，这就需要像java一样要把文件编译成class文件才能运行，
>
> 这里也一样，需要将vue文件转化成浏览器这个运行环境能识别的格式，即js、html、css，那就需要两个工具：这两个哪个都行，Vue CLI脚手架更适合Vue框架的开发。
>
> ① Webpack 打包工具
>
> ② Vue CLI 脚手架工具 



### 4.Vue CLI脚手架