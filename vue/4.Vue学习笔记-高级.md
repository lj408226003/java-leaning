## Vue学习笔记-高级



### 1.ajax框架：Axios

> xhr ==> XMLHttpRequest
>
> 这是Ajax的鼻祖，底层写法就会使用xhr来发送ajax请求，由于比较繁琐，所以后续有很多封装的框架，
>
> 比如jquery、axios(是promise风格)等，而jquery除了封装ajax他还封装了dom操作，
>
> 而dom操作有了Vue（它本身不支持ajax功能）后引入jquery就不合适了，有点臃肿，
>
> 所以我们选择axios作为ajax框架，并且他是promise风格，代码写起来也比较优雅。
>
> 
>
> Vue自己早期业开发过一个ajax框架：vue-resource，后来不用了改成全部使用 axios，具体这个见《vue-resource》章节。



### 2.脚手架配置解决跨域问题

> 什么是跨域？
>
> 当前访问的网站A的页面中，通过ajax请求其他网站B(只要协议、url、port任何一个不相同，就不算是一个网站)，这时候浏览器就会认为跨域了，
>
> 注意跨域不是不发送请求，而是A中的ajax访问B时，请求到了B，并且B已经正常响应给了A，但是打开A的发送ajax的浏览器认为收到的响应是跨域操作，所以不会解析，直接报错。

<img src="/Users/lij/markdownWorkspace/java-leaning/resources/image-20220604135927639.png" alt="image-20220604135927639" style="zoom:33%;" align="left"/>

> 解决跨域方式：
>
> ① cors方式：由后端开发将响应的头信息(Header)多增加一些特殊的响应头，浏览器看到后虽然是跨域，但是服务器说了可以给解析。
>
> ② jsonp方式：只能解决get请求的跨域，并且需要前端和后端一起配合使用，实际开发中很少应用。
>
> ③ 设置代理服务器：比如nginx，<font color="red">当然此处我们讲一下使用Vue-CLI脚手架的使用。</font>

> 注意：服务器互相访问不会存在跨域，只有浏览器本身才会有跨域问题，而服务器之间即不存在浏览器方式访问又不存在ajax，哪来的跨域。



#### ①开发环境代理服务器：devServer.proxy 

注意：运行脚手架 npm run serve服务后，她会默认占用8080端口。

> 配置vue.config.js文件：将代理服务器添加进去
>
> ```js
> module.exports = {
>     // 开启代理服务器（方式一）
>     devServer: {
>     	// 这里配置代理到的后端的服务ip:port，因为脚手架启动后默认是8080端口，而devServer.proxy又是Vue脚手架提供的功能，
>     	// 所以这个代理服务器当然也是8080端口了，而(方式一)是全部代理，
>     	// 即全部到8080端口的请求都会转发到5000端口，所以前端的所有http请求(ajax请求)只要是8080都会转发到这个规则，即5000端口
>       // 其实就是脚手架+这个代理等价与nginx的功能
>       // 但他区别于nginx的是，请求静态资源nginx需要配置前缀，而此处的代理规则是如果请求8080，而本地存在的问题件，将会直接返回而去代理到后端
>       // 所以[方式一]不太好，我们需要真正像nginx一样的功能
>       proxy: 'http://localhost:5000'
>     },
>     
>     // 开启代理服务器（方式二）：基本和nginx一样了
>     devServer: {
>       proxy: {
>         // 设置一个虚拟的请求前缀，这样请求http://localhost:8080/atguigu/list将会转发到localhost:5000/atguigu/list
>         // 但实际的请求是localhost:5000/list，所以转发前需要重写queryString部分，即删掉虚拟前缀，通过pathRewrite，当然其实也可以不写虚拟前缀
>         '/atguigu': {  
>           target: 'http://localhost:5000',
>             pathRewrite:{'^/atguigu':''},
>             // ws: true, //用于支持websocket
>           	// 用于控制请求头中的host值，默认值true，在5000这个服务获取host时，将会也是5000，false时后端获取host是真实的localhost:8080
>             // changeOrigin: true 
>         },
>         '/demo': {
>           target: 'http://localhost:5001',
>               pathRewrite:{'^/demo':''},
>           // ws: true, //用于支持websocket
>           // changeOrigin: true //用于控制请求头中的host值
>         }
>       }
>     }
> }
> ```



### 3.vue-resource

> 早期Vue 1.0版本使用vue-resource较多，Vue是以插件的形式使用vue-resource的，即Vue.use()来使用。
>
> ```js
> // 1.安装vue-resource
> npm -i vue-resource
> 
> // 2.修改main.js， 因为这里有new Vue，而插件都是在new Vue之前使用
> import App from './App.vue';
> 
> // 导入插件
> import vueResource from 'vue-resource';
> // 使用插件
> Vue.use(vueResource);
> 
> new Vue({
> ...
> })
>   
> // 3.使用，假设在Student.vue组件中使用,Vue.$http就是插件定义到Vue原型上的对象，它提供了get、post等方法
> this.$http.get();  // 他也是promise api风格
> ```
>
> 缺点：基本和axios一样的使用方式，只不过Vue官方不再维护了，交给了第三方团队维护且更新维护频率比较低，所以建议使用axios。



### 4.插槽\<slot>标签：用于组件标签内部

前边我们讲的组件标签都是这种形式\<Student />，就是没有标签体，而\<slot>插槽就是为了组件标签有标签体且标签体中添加标签时[传参]使用的。

形如：组件标签中增加一个img标签，只是这样写对于Vue是不能知道你要将img标签渲染到组件结构的哪个位置的，这就需要在组件中通过<slot>来占位，表示将img渲染到slot的位置。

> <Student>
>
> ​	<img src=""/>
>
> </Student>



分类：插槽slot共有3种类型

- 默认插槽
- 具名插槽
- 作用域插槽



> ① 默认插槽 ：就像上边说的一样，在组件内增加占位标签<slot>用于接收组件标签体中添加的html标签，举例如下：
>
> ```vue
> // 1.增加组件 Category.vue
> <template>
> 	<div class="category">
> 		<h3>{{title}}分类</h3>
> 		<!-- 定义一个插槽（占位，等着组件的使用者进行填充） -->
> 		<slot>我是一些默认值，当使用者没有传递具体结构时，我会出现</slot>
> 	</div>
> </template>
> 
> <script>
> 	export default {
> 		name:'Category',
> 		props:['title']
> 	}
> </script>
> 
> <style scoped>
> 	.category{
> 		background-color: skyblue;
> 		width: 200px;
> 		height: 300px;
> 	}
> 	h3{
> 		text-align: center;
> 		background-color: orange;
> 	}
> 	video{
> 		width: 100%;
> 	}
> 	img{
> 		width: 100%;
> 	}
> </style>
> 
> // 2.App.vue组件中引入Category.vue组件, 使用3次组件，分别使用不同的标签填充插槽
> <template>
> 	<div class="container">
> 		<Category title="美食" >
> 			<img src="https://s3.ax1x.com/2021/01/16/srJlq0.jpg" alt="">
> 		</Category>
> 
> 		<Category title="游戏" >
> 			<ul>
> 				<li v-for="(g,index) in games" :key="index">{{g}}</li>
> 			</ul>
> 		</Category>
> 
> 		<Category title="电影">
> 			<video controls src="http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4"></video>
> 		</Category>
> 	</div>
> </template>
> 
> <script>
> 	import Category from './components/Category'
> 	export default {
> 		name:'App',
> 		components:{Category},
> 		data() {
> 			return {
> 				foods:['火锅','烧烤','小龙虾','牛排'],
> 				games:['红色警戒','穿越火线','劲舞团','超级玛丽'],
> 				films:['《教父》','《拆弹专家》','《你好，李焕英》','《尚硅谷》']
> 			}
> 		},
> 	}
> </script>
> 
> <style scoped>
> 	.container{
> 		display: flex;
> 		justify-content: space-around;
> 	}
> </style>
> ```



> ② 具名插槽



> ③ 作用域插槽